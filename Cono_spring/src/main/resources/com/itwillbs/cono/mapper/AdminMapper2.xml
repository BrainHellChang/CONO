<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.cono.mapper.AdminMapper2">
	
<!-- 	회원 수 조회 -->
	<select id="selectMemberListCount" resultType="java.lang.Integer">
		SELECT COUNT(*) FROM member
	</select>
	
	<select id="selectAllMember">
		<choose>
			<when test="search.equals('') and searchType.equals('')">
				SELECT m.member_id, s.shop_idx, c.coin_total,  m.member_nick, m.member_email, m.member_phone, m.member_birth, m.member_date, m.member_status 
				FROM member m LEFT OUTER JOIN shop s
				LEFT OUTER JOIN coin c
				ON s.member_id = c.member_id
				ORDER BY m.member_date DESC
				LIMIT #{pageInfo.startRow}, #{pageInfo.listLimit}
			</when>
			<when test="search.equals('') and searchType.equals('')">
				SELECT m.member_id, s.shop_idx, c.coin_total,  m.member_nick, m.member_email, m.member_phone, m.member_birth, m.member_date, m.member_status
				FROM member m left outer JOIN shop s
				ON m.member_id = s.member_id
				left outer JOIN coin c
				ON s.member_id = c.member_id
				WHERE + searchType +  LIKE #{search}
				ORDER BY m.member_date DESC
				LIMIT #{pageInfo.startRow}, #{pageInfo.listLimit}
			</when>
		</choose>
	</select>


</mapper>